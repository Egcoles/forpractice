
-> Notification
ROLE ENDORSER 
-recieve forendorsement status
-monitor status of his/her created form

ROLE APPROVER
-recieve for approval status

ROLE ENCODER
-monitor status of his/her created form

Rouiting
-for endorsement
-->endorser can reject and put remarks
--> can approved 
-for approval
-->endorser can reject and put remarks
--> can approved 
import LegendToggleIcon from '@mui/icons-material/LegendToggle';
Module Access
-> Manage User access

	      Legend
	Endorsement Approval
      Endorsed Approved  Rejected
ENDORSER
RoleId = 31 (two rows)
Endorsement Endorsed 
Approval Approved Rejected
RoleId = 32
Endorsement Approval Approved Rejected

RoleId = 33
Approval Approved Rejected



if this is the response of the api how to display in my fornt end?
[
  {
    "mainId": 3,
    "moduleName": "",
    "date": "2025-09-09T09:16:54.8",
    "subModules": []
  },
  {
    "mainId": 4,
    "moduleName": "",
    "date": "2025-09-09T09:18:50.29",
    "subModules": []
  },
  {
    "mainId": 5,
    "moduleName": "",
    "date": "2025-09-09T09:22:10.497",
    "subModules": []
  },
  {
    "mainId": 6,
    "moduleName": "TEST MODULE",
    "date": "2025-09-09T09:31:32.183",
    "subModules": [
      {
        "subModuleId": 2,
        "mainId": 6,
        "subName": "SUB MODULE !",
        "date": "2025-09-09T09:31:32.187"
      }
    ]
  },
  {
    "mainId": 7,
    "moduleName": "Routing Approval",
    "date": "2025-09-09T09:34:17.87",
    "subModules": [
      {
        "subModuleId": 3,
        "mainId": 7,
        "subName": "PR Endorsement",
        "date": "2025-09-09T09:34:17.87"
      },
      {
        "subModuleId": 4,
        "mainId": 7,
        "subName": "PR Approval",
        "date": "2025-09-09T09:34:17.87"
      },
      {
        "subModuleId": 5,
        "mainId": 7,
        "subName": "Quotation Endorsement",
        "date": "2025-09-09T09:34:17.87"
      },
      {
        "subModuleId": 6,
        "mainId": 7,
        "subName": "Quotation Approval",
        "date": "2025-09-09T09:34:17.87"
      }
    ]
  }
]










/****** Script for SelectTopNRows command from SSMS  ******/
SELECT TOP 1000 [id]
      ,[ReferenceNo]
      ,[ControlNo]
      ,[clientName]
      ,[ProjectName]
      ,[ComapanyName]
      ,[Location]
      ,[Terms]
      ,[VAT]
      ,[Discount]
      ,[SubmittedBy]
      ,[Endorser]
      ,[Appover]
      ,[createdDate]
  FROM [PRO_USER].[dbo].[QUOTATION]


/******Script for SelectTopNRows command from SSMS  ******/
SELECT TOP 1000 [id]
      ,[QuotationID]
      ,[item]
      ,[description]
      ,[qty]
      ,[unitCost]
      ,[markup]
      ,[totalCost]
      ,[OverallTotal]
      ,[GrandTotalVAT]
      ,[CreatedDate]
  FROM [PRO_USER].[dbo].[QUOTATION_GRID]

DATABASE SCHEMA
PR TABLE
PRID
PRNUMBER
PR_REFFERENCENUMBER
PROJECTDESCRIPTION
DATENEEDED
CANVASSEDBY
ENDORSER
APPROVER
STATUS
ENTRYDATE
CREATEDBY
FORMSTATUS 

TABLE PARTICULAR
ID
PRID
ITEMID
ITEMDESCRIPTION
QTY
SUPPLIER
PRICE
TOTAL 

TBALE PR SUPPLIER
ID
ITEMID
SUPPLIERID
============================================================================================


insert 1st to PR TABLe
then insert to GRID

sample: illustration
PR TABLE
ID |PR_NUMBER |PR_REFERENCENOb |PR_PROJECTDESC |PR_DATENEEDED |PR_CANVASSEDBY |PR_ENDORSER |PR_APPROVER |PR_STATUS|PR_ENTRYDATE| PR_CREATEDBY|PR_NOTIFICATION|PR_FORMSTATUS
1  | 001      | PR001          |dfddfgsfg      |  

GRID TABLE
 ID |NewPRId| ItemId |ItemDescription |Qty 
 1  | 1     | 1      | sampl 1v       | 2  
 2  | 1     | 2      | sampl 2v       | 2  
 3  | 1     | 3      | sampl 3v       | 2  
 4  | 1     | 4      | sampl 4v       | 2  

SUPPLIER TABLE
ID | ITEMID | SUPPLIERID | PRICE | TOTAL
001 | 4     | 12         |  20   | 20
002 | 4     | 15         |  30   | 20
003 | 3     | 18         |  40   | 30
============================================================================================


CASES & Conditions FOR ADDING ROW
 1st row it require: Item, Description, Qty, Suppliers(at least one)
 New row it require: item, Description, Qty 
- check rows if has item, description, qty, supplier and price
for supplier and price must have at least one 
system will not  allow to add new row if one of them missing.
row must not be empty.

if one of the price field have value
 then clear the error message  the rest of the price for better UX.

if item and supplier is the same as the prev rows .
- throw snackbar 'you selected the same item and supplier please double check your entry."



FOR SUBMISSION 
if user forgot pricess 
it will validate on submit.
it will check if row has 
who is the supplier?
what is the item ?
how many qty?
what is the description?






Task
- username on layout
- edit and delete on user table
- purchase requisition design (form)

modification
-department delete and edit


CONDITIONS

WHEN SELECTING PATICULAR ITEM Automatically set the unit
Cannot input price

CONDITIONS ON SELECTING COMPANY NAME 
DISBALES LOCATION 
READ ONLY COMPANY ADDRESS

ENABLE LOCATION IF ALREADY SELECT COMPANY
LOCATION CHOICES WILL DEPENDS ON SELECTED COMPANY NAME
COPMANY ID WILL BE PASS AS PARAMETER TO GET THE LIST OF LOCATIONS

AUTOMICAL FILL COMPANY ADDRESS
BASED ON SELECTED LOCATION
LOCATION ID WILL BE PASS AS PARAMETER TO GET THE EXACT ADDRESS 


The MVC pattern defines the overall structure of the user interaction, while the domain model defines the core business, and the ORM handles the technical details of the database interaction.




===================================
VALIDATIONS
-cannot add new row if item,desc,qty,unitcost are empty
- duplicate item

On preview
-validate all required fields
--client name
--project name
--company name
--location
--address
--vat
submittedby
endorser
approver
each row must no empty

On submit
-enable only after preview

create 
table for company 

FUNCTIONALITY
+Select Company
=render list of location for that company
+select location
=automaticaly fill in the company address

+Select Item
= automatically fill in the item desc
= also unit is automically fill in
+Item desc is editable

*VALIDATIONS ON INPUTS*
+Input Quantity
= allow only greather than 0 
+On submit do not allow QTY == 0

+Input UnitCost 
= allow only positive numbers

+Input Markup
= allow only whole numbers
= greather than 0
+ on submit do not allow 0

+Item already selected on that row 
= if item already selected previous row 
return = 'This item already added. Please review your input '
+Total Cost is read only

**COMPUTATIONS**
PerRowComputation
Total cost = qty * unitcost
Over all total = qty * unitcost
grand total = qty * unitcost
if has markup {
  new total cost = total cost * markup%  
  new over all total = over all total * markup% 
  new grand total = grand total * markup% 
}
if has discount {
  new over all total = over all total - discount% 
  new grand total = grand total - discount%
}
if has VAT {
  new grand total = grand total * 1.12 vat
}

OverAllComputation
overall total = perRowtotalcost ++
grandtotal = perRowtotalcost ++


pag kuha ng discount ay
qty * unit cost = total cost
total cost * discount = less 
total - less = new total cost

pag kuha ng markup ay
qty * unit cost = total cost
total * cost + markup = increase price
total cost + increase price = new total cost



=======================================
QUOTATION TABLE
-Control No
- Project Name
- Client Name
-Company
- Location
-Status
-Entry Date
- Action 
=EDIT
=PRINT

QUOTATION CREATE
-clientName
-PrjectName
-companyName - need db 
-location
-CompanyAddress
-Terms
-VAT = 1.12
-discount
-submittedBy
-approver
-endorser

ITEM
-item
-qty
-unitCost
-markupPercentage
-overallTotal
-GrandTotal - if with vat 
the amount is different from overallTotal

----------------------------------------------------
FUNCTIONALITY
+Select Company
=render list of location for that company
+select location
=automaticaly fill in the company address

+Select Item
= automatically fill in the item desc
= also unit is automically fill in
+Item desc is editable

*VALIDATIONS ON INPUTS*
+Input Quantity
= allow only greather than 0 
+On submit do not allow QTY == 0

+Input UnitCost 
= allow only positive numbers

+Input Markup
= allow only whole numbers
= greather than 0
+ on submit do not allow 0

+Item already selected on that row 
= if item already selected previous row 
return = 'This item already added. Please review your input '
+Total Cost is read only

**COMPUTATIONS**
PerRowComputation
Total cost = qty * unitcost
Over all total = qty * unitcost
grand total = qty * unitcost
if has markup {
  new total cost = total cost * markup%  
  new over all total = over all total * markup% 
  new grand total = grand total * markup% 
}
if has discount {
  new over all total = over all total - discount% 
  new grand total = grand total - discount%
}
if has VAT {
  new grand total = grand total * 1.12 vat
}

OverAllComputation
overall total = perRowtotalcost ++
grandtotal = perRowtotalcost ++


pag kuha ng discount ay
qty * unit cost = total cost
total cost * discount = less 
total - less = new total cost

pag kuha ng markup ay
qty * unit cost = total cost
total * cost + markup = increase price
total cost + increase price = new total cost




-------------------------------------------------
-REPORT VIEW
-DATE REQUIRED
- PR NO
-DATE NEEDED
- PROJECT DESCRIPTION
-ITEM NO
- ITEM DESCRIPTION
- QTY
- UNIT
_ SUPPLIER
-PRICE
-TOTAL
-createdby
-CAnvassed by
-Endorser
-Approver


paanu to gagawan ng model using dapper
sympre ang view nito sa fronend ay ganto
PR NUMBER - isang valuenlng naka display 
PR_ProcjectDesc - is dn
Created by 
Canvassed by:
Endorser: 
Approver:

ITEMS ay naka populate sa table ng ganto
item id | Item Desc | Qty |Unit |Supplier ---

price bawat item and total of price bawat supplier
===============================================
MODEL
PRID
PRGRID_ID
PRNUMBEER
PROJECTDESC
ITEMID
ITEMDESC
QTY
UNIT
SUPPLIERNAME
PRICE
TOTAL
ENDROSER_NAME
APPROVER_NAME
CREATEDBY_NAME
CANVASSEDSBY_NAME
 
============================================
1.Preview slider for pdf viewer
2. Multiple Supplier selection
3. If Change access how does it need reload


Preview data: 
date
prno.
project description
item 
description,
qty,
unit,
suplier
price
total
+===========================================+
TODO:: ADD Button to Add Supplier
-table will be responsive : have a horizontal scroll

DECLARE @PRId INT = 35;

;WITH UniqueSuppliers AS (
    SELECT 
        a.PR_ID,
        a.PR_REFERENCENO,
        a.PR_PROJECTDESC,
        b.ITEMID,
        b.ITEM_DESCRIPTION,
        b.QTY,
        c.SupplierID,
        c.Price,
        c.Total,
        ROW_NUMBER() OVER(PARTITION BY a.PR_ID, b.ITEMID ORDER BY c.Price) as RowNum
    FROM 
        [PRO_USER].[dbo].[PURCHASE_REQUISITION] a
    LEFT JOIN 
        [PRO_USER].[dbo].[PR_GRID] b ON a.PR_ID = b.PRID
    LEFT JOIN 
        [PRO_USER].[dbo].[PR_SUPPLIERS] c ON b.PRGRID_Id = c.PRGRID_Id
    WHERE 
        a.PR_ID = @PRId 
        AND c.SupplierID IS NOT NULL
)
SELECT 
    PR_ID,
    PR_REFERENCENO,
    PR_PROJECTDESC,
    ITEMID,
    ITEM_DESCRIPTION,
    QTY,
    SupplierID,
    Price,
    Total
FROM 
    UniqueSuppliers
WHERE 
    RowNum = 1  -- Selects first occurrence, effectively removing duplicates
ORDER BY 
    PR_ID DESC; 